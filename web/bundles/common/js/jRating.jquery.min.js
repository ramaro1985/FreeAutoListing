!function(t){t.fn.jRating=function(s){var a={bigStarsPath:"../../../bundles/common/css/icons/stars.png",smallStarsPath:"../../../bundles/common/css/icons/small.png",phpPath:"php/jRating.php",type:"big",step:!1,isDisabled:!1,showRateInfo:!0,canRateAgain:!1,sendRequest:!0,length:5,decimalLength:0,rateMax:20,rateInfosX:-45,rateInfosY:5,nbRates:1,onSuccess:null,onError:null,onClick:null};return this.length>0?this.each(function(){function e(t){var s=parseFloat(100*t/m*parseInt(r.rateMax)/100),a=Math.pow(10,parseInt(r.decimalLength)),e=Math.round(s*a)/a;return e}function n(){switch(r.type){case"small":h=12,p=10,c=r.smallStarsPath;break;default:h=23,p=20,c=r.bigStarsPath}}function o(t){return t?t.offsetLeft+o(t.offsetParent):0}var r=t.extend(a,s),i=0,h=0,p=0,c="",l=!1,d=0,u=r.nbRates;if(t(this).hasClass("jDisabled")||r.isDisabled)var f=!0;else var f=!1;n(),t(this).height(p);{var g=parseFloat(t(this).attr("data-average")),v=parseInt(t(this).attr("data-id")),m=90,R=g/r.rateMax*90,g=(t("<div>",{"class":"jRatingColor",css:{width:R,height:"16px"}}).appendTo(t(this)),t("<div>",{"class":"jRatingAverage",css:{width:0,top:-p}}).appendTo(t(this)));t("<div>",{"class":"jStar",css:{width:"90px",height:"20px",top:"-36px",background:"url("+c+") repeat-x"}}).appendTo(t(this))}t(this).css({width:m,overflow:"hidden",zIndex:1,position:"relative"}),f||t(this).unbind().bind({mouseenter:function(s){var a=o(this),n=s.pageX-a;if(r.showRateInfo){t("<p>",{"class":"jRatingInfos",html:e(n)+' <span class="maxRate">/ '+r.rateMax+"</span>",css:{top:s.pageY+r.rateInfosY,left:s.pageX+r.rateInfosX}}).appendTo("body").show()}},mouseover:function(){t(this).css("cursor","pointer")},mouseout:function(){t(this).css("cursor","default"),g.width(l?d:0)},mousemove:function(s){var a=o(this),n=s.pageX-a;i=r.step?Math.floor(n/h)*h+h:n,g.width(i),r.showRateInfo&&t("p.jRatingInfos").css({left:s.pageX+r.rateInfosX}).html(e(i)+' <span class="maxRate">/ '+r.rateMax+"</span>")},mouseleave:function(){t("p.jRatingInfos").remove()},click:function(s){var a=this;l=!0,d=i,u--,(!r.canRateAgain||parseInt(u)<=0)&&t(this).unbind().css("cursor","default").addClass("jDisabled"),r.showRateInfo&&t("p.jRatingInfos").fadeOut("fast",function(){t(this).remove()}),s.preventDefault();var n=e(i);g.width(i),t(".datasSent p").html("<strong>idBox : </strong>"+v+"<br /><strong>rate : </strong>"+n+"<br /><strong>action :</strong> rating"),t(".serverResponse p").html("<strong>Loading...</strong>"),r.onClick&&r.onClick(a,n),r.sendRequest&&t.post(r.phpPath,{idBox:v,rate:n,action:"rating"},function(s){s.error?(t(".serverResponse p").html(s.server),r.onError&&r.onError(a,n)):(t(".serverResponse p").html(s.server),r.onSuccess&&r.onSuccess(a,n))},"json")}})}):void 0}}(jQuery);