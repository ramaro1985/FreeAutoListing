<style>
    /* .col-sm-2 {
         width: 18.667%;
     }

     .mobile label {
         font-weight: normal;
     }

     .checkbox label, .radio label {
         padding-left: 0px;
     }

     .mobile .panel-heading {
         border-bottom: 1px solid transparent;
         border-top-left-radius: 0px !important;
         border-top-right-radius: 0px !important;;
         padding: 10px 15px;
         background-color: #e4e4e4;
         border-color: #b8b8b8;
     }

     .panel-heading li {
         list-style: none;
         margin-right: 0px !important;
         margin-left: 0px !important;
         font-size: 18px;
     }

     .glyphicon {
         top: 0px;
     }

     .glyphicon-info-sign {
         font-size: 14px;
     }

     .panel-default .panel-collapse {
         font-size: 14px;
         *//* margin-left: 15px;
          margin-right: 12px;*//*
         margin-top: 15px;
     }*/

</style>
<div class="panel-heading" style="background-color: #b8b8b8;border-color: #b8b8b8;color:#ffffff;">
    <div class="container-fluid no_padding">
        <h2 class="panel-title" style="font-size: 23px;">Add new Car</h2>
    </div>
</div>
<div class="mobile" style="background-color: #ffffff">
<div class="panel-body" style="padding: 0px;">
<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true"
     style="margin-left: 1px;margin-right: 1px">
<div class="panel panel-default" style="border: none">
<div class="panel-heading" role="tab" id="headingOne">
    <li class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
        href="#collapseOne" aria-expanded="false" aria-controls="collapseOne in">
                         <span class="pull-right"><span
                                     class="glyphicon glyphicon-info-sign glyphicon-align-right nochange"
                                     aria-hidden="true" style="margin-left: 10px;"></span></span>Vehicle
        Information
    </li>
</div>
<div id="collapseOne"
     class="col-md-12 panel-collapse collapse {% if (prop_pk != "no" and vehicle_id == 'new') or tabActive=='tabActive' %} in{% endif %}"
     role="tabpanel" {% if  (prop_pk != "no" and vehicle_id == 'new') or tabActive=='tabActive' %} %} aria-expanded="true"{% endif %}
aria-labelledby="headingOne">

<form id="form-vehicle-info" {{ form_enctype(form) }}
      method="POST" class="form-horizontal formulario" style="margin-top: 20px">
<input type="hidden" name="_csrf_token" value="{{ csrf_token('registration') }}">


<div class="form-group" style="margin-bottom: 25px">
    <div class="col-sm-3 col-xs-12 text-left">
        <span style="color: red">*</span>
        <label class="required" for="dealer">Select a dealer from the list</label>
    </div>
    <div class="col-sm-5 col-xs-12 ">

        <div class="btn-group-vertical btn-group-lg" style="width: 100%">
            <div id="dealer" class="dropdown" class="form-control"
                 required="required">
                <button id="dealerselect_btn"
                        class="btn btn-default dropdown-toggle panel_button btn-lg"
                        aria-expanded="true" aria-haspopup="true"
                        data-toggle="dropdown" type="button"
                        style="width: 99%;text-align: right">
                                                                <span class="pull-left">
                                                                    {% if profile_selected != "" %}
                                                                        {{ profile_selected }}
                                                                    {% else %}
                                                                        Select
                                                                    {% endif %}
                                                                  </span>
                    <span class="caret"></span>
                </button>
                <ul class="dropdown-menu dropdown_list"
                    aria-labelledby="dealerselect_btn">
                    {% if profiles is defined %}
                        {% for profile in profiles %}
                            <li>
                                <a href="{{ path('create_vehicle_basic_info',{'type':'open' , 'prop_pk': profile.prop_pk , 'vehicle_id': 'new' }) }}"
                                   value="dealerselected_{{ profile.prop_pk }}">{{ profile.name }}</a>
                            </li>
                        {% endfor %}
                    {% endif %}
                </ul>
            </div>
        </div>
    </div>
</div>


<div class="form-group">
    <div class="col-md-11 col-xs-12 text-left">
        <p>This is the basic information needed to create your ad. It will appear in
            your listing
            and detailed
            ad</p>
    </div>
</div>

<div class=""
     style="margin-top: 10px;  color: #888888 !important;">

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red;position: absolute">*</span>
            <label for="vehicle_vehiclesinformation_zipcode" style="margin-left: 10px"
                   class="required">Zip
                Code where vehicle <br> will be sold</label>
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesinformation.zipcode) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.zipcode) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesinformation.vin) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesinformation.vin) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.vin) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesinformation.condition) }}
        </div>
        <div class="col-sm-5 col-xs-12 ">
            {{ form_widget(form.vehiclesinformation.condition) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.condition) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesinformation.year) }}
        </div>
        <div class="col-sm-5 col-xs-12 ">
            {{ form_widget(form.vehiclesinformation.year) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.year) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            <label class="required" for="vehicle_vehiclesinformation_make">Make</label>
            <img id="vehicle_vehiclesinformation_make_loading" class="hide"
                 src="{{ asset('bundles/common/images/loading.gif') }}" alt=""/>
        </div>
        <div class="col-sm-5 col-xs-12 ">
            <select id="vehicle_vehiclesinformation_make" class="form-control"
                    required="required"
                    name="make">
                {% if make == null %}
                    <option selected="selected" value="0">Select a Make</option>
                {% else %}
                    <option selected="selected"
                            value="{{ make.id }}">{{ make.makeId }}</option>
                {% endif %}
            </select>
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            <label class="required"
                   for="vehicle_vehiclesinformation_model">Model</label>
            <img id="vehicle_vehiclesinformation_model_loading" class="hide"
                 src="{{ asset('bundles/common/images/loading.gif') }}" alt=""/>
        </div>
        <div class="col-sm-5 col-xs-12 ">
            <select id="vehicle_vehiclesinformation_model" class="form-control"
                    required="required"
                    name="model">

                {% if model == null %}
                    <option selected="selected" value="0">Select a Model</option>
                {% else %}
                    <option selected="selected"
                            value="{{ model.id }}">{{ model.modelId }}</option>
                {% endif %}
            </select>
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            <label for="vehicle_vehiclesdetails_trim">Trim</label>
            <img id="vehicle_vehiclesdetails_trim_loading" class="hide"
                 src="{{ asset('bundles/common/images/loading.gif') }}" alt=""/>
        </div>
        <div class="col-sm-5 col-xs-12">
            <select id="vehicle_vehiclesdetails_trim" class="form-control"
                    name="trim">
                {% if trim == null %}
                    <option value="0">Select a Trim</option>
                {% else %}
                    <option selected="selected"
                            value="{{ trim.id }}">{{ trim.trimId }}</option>
                {% endif %}
            </select>
        </div>
    </div>
    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesinformation.bodystyle) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesinformation.bodystyle) }}
        </div>

        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.bodystyle) }}
        </div>
    </div>
    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesinformation.mileage) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesinformation.mileage) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.mileage) }}
        </div>
    </div>
    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesinformation.price) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesinformation.price) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.price) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red"></span>
            &nbsp;&nbsp;{{ form_label(form.vehiclesinformation.msrp) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesinformation.msrp) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.msrp) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesinformation.stock_number) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesinformation.stock_number) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesinformation.stock_number) }}
        </div>
    </div>
</div>


<div class="form-group">
    <div class="col-md-11 col-xs-12 text-left">
        <h2>More Details</h2>
        <span>The more details you provice, the more activity your liting will receive</span>
    </div>
</div>


<div class=""
     style="margin-top: 20px; color: #888888 !important;">
    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesdetails.doors) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesdetails.doors) }}
        </div>

        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesdetails.doors) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesdetails.enginetype) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesdetails.enginetype) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesdetails.enginetype) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesdetails.transmission) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesdetails.transmission) }}
        </div>

        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesdetails.transmission) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesdetails.fueltype) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesdetails.fueltype) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesdetails.fueltype) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesdetails.drive) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesdetails.drive) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesdetails.drive) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px;">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesdetails.exteriorcolor) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesdetails.exteriorcolor) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesdetails.exteriorcolor) }}
        </div>
    </div>

    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-3 col-xs-12 text-left">
            <span style="color: red">*</span>
            {{ form_label(form.vehiclesdetails.interiorcolor) }}
        </div>
        <div class="col-sm-5 col-xs-12">
            {{ form_widget(form.vehiclesdetails.interiorcolor) }}
        </div>
        <div class="col-sm-3 col-xs-12 text-danger">
            {{ form_errors(form.vehiclesdetails.interiorcolor) }}
        </div>
    </div>
</div>
<div class="col-md-12 text-left" style="margin-top: 20px">
    <div class="form-group" style="margin-bottom: 10px">
        <div class="col-sm-12 col-xs-12 text-left" style="margin-top: 10px;">
            <button id="btnsave" type="submit" class="btn btn-primary"
                    style="margin-left: 10px;margin-bottom: 10px">Save
            </button>
            <button id="btnsavecontinue" type="" class="btn btn-primary"
                    style="margin-left: 10px;margin-bottom: 10px">
                Save &
                Continue
            </button>
        </div>
    </div>
</div>
<input type="hidden" name="tabActive" id="tabActive" value="0">
{{ form_rest(form) }}
</form>

</div>
</div>
{% if vehicle_id != 'new' %}
    <style>
        .btn-group-vertical >
        .container::after,
        .form-horizontal .form-group::after {
            clear: none !important;
        }
    </style>
    <div class="panel panel-default" style="border: none">
        <div class="panel-heading" role="tab" id="headingTwo">
            <li class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                href="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                         <span class="pull-right"><span class="fal_icon icon-inventary"
                                                        aria-hidden="true" style="margin-left: 10px;"></span></span>Vehicle
                Options
            </li>
        </div>
        <div id="collapseTwo"
             class="col-md-12 panel-collapse collapse {% if tabActive =='tabActiveOption' %} in{% endif %}"
             role="tabpanel" {% if tabActive=='tabActiveOption' %} aria-expanded="true" {% endif %}
             aria-labelledby="headingTwo">

            <form id="form-vehicle-options"
                  action="" {{ form_enctype(formOption) }}
                  method="POST" class="form-horizontal">
                <input type="hidden" name="_csrf_token" value="{{ csrf_token('registration') }}">


                    <div class="form-group">
                        <div class="col-xs-12 text-left form-title">
                            Vehicles Options
                        </div>

                        <div class="col-sm-12 col-xs-12 text-left">
                            <p>Be as specific as possible.The more information you provide, the more
                                activity the listing will receive</p>
                        </div>
                    </div>


                {#<div class="col-md-12 col-xs-12" style="font-size: 12px">#}
                    <div class="form-group form-inline">
                            {% set totalOptions = (-formOption.vehiclesoptions|length // 2) %}
                            {% set aux = 0 %}
                            {% for i in range(0,totalOptions) %}
                                <div style="padding-top: 15px">
                                    <div class="col-xs-12 checkbox-inline">
                                        {% for option in formOption.vehiclesoptions|slice( aux, 2 ) %}
                                            <div class="col-xs-6 text-left">
                                                {{ form_widget(option) }} {{ form_label(option) }}
                                            </div>
                                        {% endfor %}
                                        {% set aux = aux + 2 %}
                                    </div>
                                </div>
                            {% endfor %}
                    </div>
                {#</div>#}
                <div class="col-md-10 text-center" style="margin-top: 25px">
                    <div class="form-group" style="margin-bottom: 10px">
                        <div class="col-sm-12 col-xs-12 text-left">
                            <button id="btnsaveOption" type="submit" class="btn btn-primary"
                                    style="margin-left: 10px;margin-bottom: 10px">Save
                            </button>
                            <button id="btnsavecontinueOption" type="submit" class="btn btn-primary"
                                    style="margin-left: 10px;margin-bottom: 10px">Save
                                &
                                Continue
                            </button>
                        </div>
                    </div>

                </div>
                <input type="hidden" name="ismobile" id="ismobile" value="true">
                <input type="hidden" name="tabActiveOption" id="tabActiveOption" value="0">
                {{ form_rest(formOption) }}
            </form>
        </div>
    </div>
{% endif %}
{% if VOptions is not null %}
    <style type="text/css">
        .thumbnail {
            cursor: move;
        }
    </style>
    <div class="panel panel-default" style="border: none">
        <div class="panel-heading" role="tab" id="heading3">
            <li class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                href="#collapse3" aria-expanded="false" aria-controls="collapse3">
                         <span class="pull-right"><span class="fal_icon icon-photo"
                                                        aria-hidden="true" style="margin-left: 10px;"></span></span>Photos
            </li>
        </div>
        <div id="collapse3"
             class="col-md-12 panel-collapse collapse{% if VGalleryOpen is not null %} in{% endif %}"
             role="tabpanel"{% if VGalleryOpen is not null %} aria-expanded="true"{% endif %}
             aria-labelledby="heading3">

            <p style="margin-top: 10px">Upload your vehicle pictures and add a title or a brief description. The
                first image in the gallery will be your Featured Picture.If you don't have the photos handy,
                dont't worry.
                You can add or edit them after you complete your ad using the "Edit" button. </p>

            <p style="margin-top: 15px;margin-bottom: 15px">
                <a href="{{ path('vehicle_seller_comments', {'type':'open' , 'prop_pk':prop_pk, 'vehicle_id': vehicle_id}) }}"
                   style="text-decoration: no-underline;color: #3763ff">Skip this step</a> and upload photos later.
            </p>

            <div class="form-group" style="margin-bottom: 10px">

                                <span class="btn btn-default b2b active pull-left" data-toggle="modal"
                                      data-target="#myModalGallery"
                                      style="margin-bottom: 10px; margin-top: 10px;">
                                <i class="glyphicon glyphicon-plus"></i>
                                <span>Add Photos...</span>
                              </span>

            </div>
            <form id="form-vehicle-photos"
                  action="" {{ form_enctype(formGall) }}
                  method="POST" class="form-horizontal" style="margin-top: 20px">
                <input type="hidden" name="_csrf_token" value="{{ csrf_token('registration') }}">

                <div class="col-sm-12 col-xs-12 text-left text-danger gallery-error no_padding">
                    {% if formGall.vars is defined %}
                        {% if not formGall.vars.valid %}
                            {% for prop in formGall.profileImages %}
                                {{ form_errors(prop.photo) }}
                            {% endfor %}
                        {% endif %}
                    {% endif %}
                </div>

                <div>

                    <div class="form-group" style="margin-bottom: 10px">
                        <div class="col-xs-12 text-left form-title">
                            <div style="margin-right: 20px"><a
                                        class="pull-left btn btn-default uploadMultipleVisible hide" href="#">Upload
                                    Multiple Images</a></div>

                        </div>

                        <div class="col-xs-6 col-sm-6 text-left top-content" style="padding-left: 15px">
                            <div class="tumb-large"></div>

                        </div>
                        <div class="col-xs-6 col-sm-6 text-left top-content"
                             style="margin-top: 115px;min-height: 21px">
                            <div class="title featured-picture" style="font-size: 16px;color: #2c9ec8;position: absolute;">
                                Featured
                                Picture
                            </div>
                        </div>
                        <div class="col-xs-6 col-sm-6 text-left top-content">
                            <div class="title"><label>Description / Title</label></div>
                        </div>
                        <div class="col-xs-6 col-sm-6 title-input top-content">
                            <input type="text" class="form-control">
                        </div>
                        <div class="col-md-2 col-xs-2 text-left top-content" style="margin-top: 5px">

                            <img id="loading" src="{{ asset('bundles/common/images/loading.gif') }}"
                                 style="margin-left: 5px; border: 0 none;" class="hide">
                        </div>

                        <div class="col-md-12 col-xs-12 text-left" style="margin-top: 20px">

                            <div class="title" style="font-size: 16px;color: #2c9ec8">Drag photos to change order
                            </div>

                        </div>
                    </div>


                    <div class="row gallery" id="gallery">
                        {% if formGall.profileImages| length > 0 %}
                            {% for i in 0..7 %}

                                <div class="row col-xs-3 text-left no_padding" style="padding-right: 2px;margin-bottom: 10px">
                                    <div class="image-form">
                                        {% if formGall.profileImages[i] is defined %}
                                            {% if formGall.profileImages[i].vars.data.getWebPath is not null %}
                                                <div class="tumb old"
                                                     style="background-image:url('{{ asset(formGall.profileImages[i].vars.data.getWebPathThumbnailVehicle(prop,vehicle_id)) }}');"></div>
                                            {% else %}
                                                <div id="gallery_propertyImages_{{ i }}" class="tumb upload"
                                                     style="background-image:url('{{ asset('bundles/common/images/image-bg.jpg') }}');"></div>
                                            {% endif %}
                                            <span id="orden"
                                                  class="hide">{{ form_widget(formGall.profileImages[i].orden) }}</span>

                                            <div class="col-md-1 col-xs-12 hide">
                                                {{ form_widget(formGall.profileImages[i].photo) }}
                                            </div>

                                            <div class="col-md-1 col-xs-12 title-input-source hide">
                                                {{ form_widget(formGall.profileImages[i].title) }}

                                            </div>
                                            <div class="col-md-1 col-xs-12" style="padding: 0">
                                                {% set picture  = formGall.profileImages[i].vars.value %}
                                                <input id="pictureId" type="hidden" value="{{ picture.id }}">

                                            </div>
                                        {% else %}
                                            {{ include('AdminBundle:Default:image-form.html.twig',{ 'i': i}) }}
                                        {% endif %}
                                    </div>
                                    <span class="orden"> {% set orden = i+1 %}{{ orden }}</span>
                                    {% if formGall.profileImages[i].vars.data.getWebPath is defined %}
                                        {% if formGall.profileImages[i].vars.data.getWebPath is not null %}
                                            <a href="#" class="deleteImage"><span class="glyphicon glyphicon-trash"
                                                                                  aria-hidden="true"
                                                                                  style="font-size: 12px; margin-left: 5px; top:1px"></span></a>
                                        {% else %}
                                            <a href="#" class="hide deleteImage"><span class="glyphicon glyphicon-trash"
                                                                                       aria-hidden="true"
                                                                                       style="font-size: 12px; margin-left: 5px; top:1px"></span></a>
                                        {% endif %}
                                    {% else %}
                                        <a href="#" class="hide deleteImagePreview"><span
                                                    class="glyphicon glyphicon-trash"
                                                    aria-hidden="true"
                                                    style="font-size: 12px; margin-left: 5px; top:1px"></span></a>
                                    {% endif %}
                                </div>
                            {% endfor %}
                        {% endif %}
                    </div>
                    <div id="result" class=""></div>
                </div>

                <div id="form-buttons" class="col-xs-10 text-center no_padding" style="margin-top: 20px">
                    <div class="form-group" style="margin-bottom: 10px">
                        <div class="col-sm-12 col-xs-12 text-left" style="padding-left:8px;">
                            <!-- <button id="btnsave" type="submit" class="btn btn-primary">Save</button>-->
                            <button id="btnsavecontinueGall" type="submit" class="btn btn-primary"
                                    style="margin-left: 10px">
                                Save & Continue
                            </button>
                        </div>
                    </div>
                </div>
                <input type="hidden" name="ismobile" id="ismobile" value="true">
                <input type="hidden" name="tabActiveGall" id="tabActiveGall" value="0">

                <div style="display: none">{{ form_rest(formGall) }}</div>
            </form>
        </div>
    </div>
{% endif %}
{% if VGallery is not null %}
    <div class="panel panel-default" style="border: none">
        <div class="panel-heading" role="tab" id="heading3">
            <li class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                href="#collapse4" aria-expanded="false" aria-controls="collapse4">
                         <span class="pull-right"><span class="glyphicon waranty_icon nochange"
                                                        aria-hidden="true" style="margin-left: 10px;"></span></span>Warranty
            </li>
        </div>
        <div id="collapse4"
             class="col-xs-12 panel-collapse collapse{% if tabActive =='tabActiveWarr' %} in{% endif %}"
             role="tabpanel"{% if tabActive =='tabActiveWarr' %} aria-expanded="true"{% endif %}
             aria-labelledby="heading4">

            <form id="form-vehicle-warranty"
                  action="" {{ form_enctype(formWarr) }}
                  method="POST" class="form-horizontal formulario">
                <input type="hidden" name="_csrf_token" value="{{ csrf_token('registration') }}">


                    <div class="form-group">
                        <div class="col-md-12 col-xs-12 text-left">
                            <p>Warranty Description</p>
                        </div>
                    </div>
                    <div class="form-group" style="margin-bottom: 10px">
                        <div class="col-sm-12 col-xs-12">
                            {{ form_widget(formWarr.warranty) }}
                            <div class="pull-right form-inline">
                                <label for="count_back" style="font-size: 12px">Characters remaining</label>
                                <input class="counter_input" type="text" id="count_back" name="count_back"
                                       value="800" size="4px">
                            </div>
                        </div>
                    </div>

                    <div class="form-group" style="margin-bottom: 10px">
                        <div class="col-sm-12 col-xs-12 text-left">
                            <button id="btnsaveWarr" type="submit" class="btn btn-primary"
                                    style="margin-left: 10px;margin-bottom: 10px">Save
                            </button>
                            <button id="btnsavecontinueWarr" type="" class="btn btn-primary"
                                    style="margin-left: 10px;margin-bottom: 10px">
                                Save &
                                Continue
                            </button>
                        </div>
                    </div>

                <input type="hidden" name="ismobile" id="ismobile" value="true">
                <input type="hidden" name="tabActiveWarr" id="tabActiveWarr" value="0">
                {{ form_rest(formWarr) }}
            </form>
        </div>
    </div>
{% endif %}
{% if VWarranty is not null %}
    <div class="panel panel-default" style="border: none">
        <div class="panel-heading" role="tab" id="heading3">
            <li class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion"
                href="#collapse5" aria-expanded="false" aria-controls="collapse5">
                         <span class="pull-right"><span class="glyphicon glyphicon-info-sign glyphicon-align-right nochange"
                                                        aria-hidden="true" style="margin-left: 10px;"></span></span>Seller
                Comments
            </li>
        </div>
        <div id="collapse5"
             class="col-md-12 panel-collapse collapse{% if tabActive =='tabActiveSell' %} in{% endif %}"
             role="tabpanel"{% if tabActive =='tabActiveSell' %} aria-expanded="true"{% endif %}
             aria-labelledby="heading5">
            <form id="form-vehicle-sellercommemts"
                  action="" {{ form_enctype(formSeller) }}
                  method="POST" class="form-horizontal formulario">
                <input type="hidden" name="_csrf_token" value="{{ csrf_token('registration') }}">

                                <p>
                                    This your chance to tell shoppers your vehicle in yor own words.We've
                                    already captured
                                    the year, make and model, so
                                    focus more on unique selling points.Explain to shoppers why you're
                                    selling
                                    and disclose
                                    any prior maintenance.Give warranty
                                    information and detail anu modification made to you car.Above all, be
                                    honest
                                    with
                                    shoppers.After your ad is placed, you can come
                                    back anytime to edit your ad details.Please note:We don't recommend
                                    entering
                                    your phone
                                    number or email address in this space.
                                    We'll give shoppers access to your contact information on your ad.
                                </p>

                    <div class="form-group" style="margin-bottom: 10px">
                        <div class="col-sm-12 col-xs-12">
                            {{ form_widget(formSeller.seller_comments) }}
                            <div class="pull-right form-inline" style="margin-top: 10px;">
                                <label for="count_back1" style="font-size: 12px">Characters
                                    remaining</label>
                                <input class="counter_input1" type="text" id="count_back1"
                                       name="count_back1"
                                       value="800" size="4px">
                            </div>
                        </div>
                    </div>


                    <div class="form-group" style="margin-bottom: 10px">
                        <div class="col-sm-12 col-xs-12 text-left">
                            <!-- <button id="btnsave" type="submit" class="btn btn-primary">Save</button>-->
                            <button id="btnsavefinish" type="" class="btn btn-primary"
                                    style="margin-left: 10px">
                                Save &
                                Finish
                            </button>
                        </div>
                    </div>

                <input type="hidden" name="tabActiveSell" id="tabActiveSell" value="0">
                <input type="hidden" name="ismobile" id="ismobile" value="true">

                {{ form_rest(formSeller) }}
            </form>
        </div>
    </div>
{% endif %}
</div>
</div>
</div>
<div class="modal fade" id="myModalGallery" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     data-backdrop="static" data-keyboard="false">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="myModalLabel">Upload Images</h4>
            </div>
            <div class="modal-body">
                <div class="row">
                    <div class="col-md-12 col-xs-12">
                        <div class="form-group">
                            <div class="col-md-11 col-xs-12 text-left">
                                <div style="margin-right: 20px" class="text-danger"><em>Maximum image
                                        size allowed
                                        is 5
                                        MB</em></div>
                                <div class="text-danger"><em>Minimum image dimensions requirements (400
                                        x 285)</em>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12 col-xs-12 text-left" style="padding-left: 30px">

                                <span id="selectfile" class="btn btn-default active fileinput-button pull-left"
                                      style="margin-bottom: 10px; margin-top: 10px;">
                                    <i class="glyphicon glyphicon-picture" style="margin-right: 7px"></i>
                                <span>Select files...</span>
                                <!-- The file input field used as target for the file upload widget -->

                            </span>
                        <input class="hide" id="fileupload" type="file" accept="image/*" name="files[]"
                               multiple>

                        <div class="pull-left text-muted uploading hide"
                             style="padding-top: 15px; padding-left: 15px">
                            Uploading Images <img id="loading"
                                                  src="{{ asset('bundles/common/images/loading.gif') }}"
                                                  style="margin-left: 5px; border: 0 none;" class="">
                        </div>


                        <!-- The container for the uploaded files -->


                    </div>
                    <div id="files" class="files col-md-12 col-xs-12 text-left"
                         style="padding-left: 30px"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-default close-upload" data-dismiss="modal">Close
                </button>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">


jQuery(function () {
    'use strict';
    // Change this to the location of your server-side upload handler:
    var url = "{{ path('upload_multiple_vehicle', {'prop_pk': prop_pk,'vehicle_id': vehicle_id}) }}",
            uploadButton = jQuery('<button/>')
                    .addClass('btn btn-primary')
                    .prop('disabled', true)
                    .text('Processing...')
                    .on('click', function () {
                        var $this = $(this),
                                data = $this.data();
                        $this
                                .off('click')
                                .text('Abort')
                                .on('click', function () {
                                    $this.remove();
                                    data.abort();
                                });
                        data.submit().always(function () {
                            $this.remove();
                        });
                    });

    var maxFiles = 24;
    var counter = 0;
    jQuery('#fileupload').fileupload({
        url: url,
        dataType: 'json',
        autoUpload: true,
        acceptFileTypes: /(\.|\/)(gif|jpe?g|png)$/i,
        // Enable image resizing, except for Android and Opera,
        // which actually support image resizing, but fail to
        // send Blob objects via XHR requests:
        disableImageResize: true,
        previewMaxWidth: 100,
        previewMaxHeight: 100,
        previewCrop: true
    }).on('fileuploadadd', function (e, data) {

        if (counter < maxFiles) {
            counter++;
        } else {
            return false;
        }


        data.context = jQuery('<div/>').appendTo('#files');
        jQuery.each(data.files, function (index, file) {

            var node = jQuery('<p/>')
                    .append(jQuery('<span/>').text(file.name));
            if (!index) {
                node.append(' ');
            }

            node.appendTo(data.context);
        });
    }).on('fileuploadprocessalways', function (e, data) {

        var index = data.index,
                file = data.files[index],
                node = jQuery(data.context.children()[index]);
        /*if (file.preview) {
         node
         .prepend('<br>')
         .prepend(file.preview);
         }*/


        if (file.error) {
            node.append(jQuery('<span class="text-danger"/>').text(file.error));
        }
        if (index + 1 === data.files.length) {
            data.context.find('button')
                    .text('Upload')
                    .prop('disabled', !!data.files.error);
        }
    }).on('fileuploaddone', function (e, data) {
        jQuery.each(data.result.files, function (index, file) {
            /* if (file.url) {
             var link = jQuery('<a>')
             .attr('target', '_blank')
             .prop('href', file.url);
             jQuery(data.context.children()[index])
             .wrap(link);
             } else*/
            if (file.error) {
                var error = jQuery('<span class="text-danger"/>').text(file.error);
                jQuery(data.context.children()[index]).append(' ').append(error);
            } else {
                var success = jQuery('<span class="text-success"/>').text('Uploaded');
                jQuery(data.context.children()[index]).append(' ').append(success);
            }
        });
    }).on('fileuploadfail', function (e, data) {
        jQuery.each(data.files, function (index) {
            var error = jQuery('<span class="text-danger"/>').text('File upload failed.');
            jQuery(data.context.children()[index])
                    .append(' ')
                    .append(error);
        });
    }).prop('disabled', !jQuery.support.fileInput)
            .parent().addClass(jQuery.support.fileInput ? undefined : 'disabled');
});

jQuery(function () {
    jQuery('#fileupload').bind('fileuploadstop', function (e) {
        jQuery('.uploading').addClass('hide');
        jQuery('.fileinput-button').removeAttr('disabled');
        jQuery('#form-location #btnsave').removeClass('disabled');
        jQuery('#form-location #btnsavecontinue').removeClass('disabled');
        jQuery('.deleteImage').each(function () {
            jQuery(this).removeClass('hide');
        });
        jQuery('#link-tab-index-1, #link-tab-index-2, #link-tab-index-4, #link-tab-index-6, #link-tab-index-5, #link-tab-index-3, #link-tab-index-7,#link-tab-index-8').removeClass('disabled');
        window.location = "{{ path('vehicle_gallery' , {'type':'open' , 'prop_pk':prop_pk, 'vehicle_id': vehicle_id}) }}";
    });

});

jQuery(function () {
    jQuery('#fileupload').bind('fileuploadstart', function (e) {
        //jQuery('#myModalGallery').attr('data-backdrop', 'static');
        //jQuery('#myModalGallery').attr('data-keyboard', "false");
        jQuery('.uploading').removeClass('hide');
        jQuery('.fileinput-button').attr('disabled', 'disabled');
        jQuery('.close-upload').attr('disabled', 'disabled');
        jQuery('.deleteImage').each(function () {
            jQuery(this).addClass('hide');
        });
        //jQuery('#link-tab-index-1, #link-tab-index-2, #link-tab-index-4, #link-tab-index-6, #link-tab-index-5, #link-tab-index-3, #link-tab-index-7').addClass('disabled');
        jQuery('#form-vehicle-photos #btnsave').addClass('disabled');
        jQuery('#form-vehicle-photos #btnsavecontinue').addClass('disabled');
    });

});

jQuery(document).ajaxStart(function () {
    jQuery("#loading").removeClass('hide');
});

jQuery(document).ajaxStop(function () {
    jQuery("#loading").addClass('hide');
});

jQuery(document).ready(function () {

    function createPopover(elem, text) {
        elem.attr('data-toggle', 'popover');
        //elem.attr('data-placement', 'right');
        elem.attr('data-placement', 'bottom');
        elem.attr('data-content', text);
        elem.attr('data-container', 'body');
        elem.popover();
        elem.trigger('click');
        elem.focus();
    }

    function checkSelected(o) {
        if (o.val() == 0) {
            createPopover(o, 'Please fill out this field');
            return false;
        } else {
            return true;
        }
    }

    jQuery('#btnsavecontinue').click(function (e) {

        var bValid = true;
        bValid = bValid && checkSelected(jQuery('#selected_prop_pk'));
        bValid = bValid && checkSelected(jQuery('#vehicle_vehiclesinformation_make'));
        bValid = bValid && checkSelected(jQuery('#vehicle_vehiclesinformation_model'));
        bValid = bValid && checkSelected(jQuery('#vehicle_vehiclesdetails_trim'));
        if (bValid) {
            jQuery('#tabActiveOption').val('tabActiveOption');
            jQuery('#form-vehicle-info').attr('action', "{{path('create_vehicle_basic_info', {'type':'continue' , 'prop_pk':prop_pk, 'vehicle_id': vehicle_id})}}");
            jQuery('#form-vehicle-info').submit();
        }
    });

    jQuery('#btnsave').click(function (e) {

        var bValid = true;
        bValid = bValid && checkSelected(jQuery('#selected_prop_pk'));
        bValid = bValid && checkSelected(jQuery('#vehicle_vehiclesinformation_make'));
        bValid = bValid && checkSelected(jQuery('#vehicle_vehiclesinformation_model'));
        bValid = bValid && checkSelected(jQuery('#vehicle_vehiclesdetails_trim'));
        if (bValid) {
            jQuery('#tabActive').val('tabActive');
            jQuery('#form-vehicle-info').attr('action', "{{path('create_vehicle_basic_info', {'type':'continue' , 'prop_pk':prop_pk, 'vehicle_id': vehicle_id})}}");
            jQuery('#form-vehicle-info').submit();
        }
    });

    jQuery('#btnsavecontinueOption').click(function (e) {
        jQuery('#tabActiveOption').val(0);
        jQuery('#form-vehicle-options').attr('action', "{{path('vehicle_options', {'type':'continue' , 'prop_pk':prop_pk, 'vehicle_id': vehicle_id})}}");
    });
    jQuery('#btnsaveOption').click(function (e) {
        jQuery('#tabActiveOption').val('tabActiveOption');
        jQuery('#form-vehicle-options').attr('action', "{{path('vehicle_options', {'type':'continue' , 'prop_pk':prop_pk, 'vehicle_id': vehicle_id})}}");
    });

    jQuery('#btnsavecontinueGall').click(function (e) {
        jQuery('#tabActiveGall').val('tabActiveWarr');
        jQuery('#form-vehicle-photos').attr('action', "{{path('vehicle_gallery', {'type':'continue' , 'prop_pk':prop_pk, 'vehicle_id':vehicle_id})}}");
    });

    jQuery('#btnsavecontinueWarr').click(function (e) {
        jQuery('#tabActiveWarr').val('tabActiveSell');
        jQuery('#form-vehicle-warranty').attr('action', "{{path('vehicle_warranty', {'type':'continue' , 'prop_pk':prop_pk, 'vehicle_id': vehicle_id})}}");
    });
    jQuery('#btnsaveWarr').click(function (e) {
        jQuery('#tabActiveWarr').val('tabActiveWarr');
        jQuery('#form-vehicle-warranty').attr('action', "{{path('vehicle_warranty', {'type':'continue' , 'prop_pk':prop_pk, 'vehicle_id': vehicle_id})}}");
    });

    jQuery('#btnsavefinish').click(function (e) {
        jQuery('#form-vehicle-sellercommemts').attr('action', "{{path('vehicle_seller_comments', {'type':'continue' , 'prop_pk':prop_pk , 'vehicle_id': vehicle_id })}}");
    });

    jQuery(function () {
        jQuery(".glyphicon-info-sign").tooltip();
    });

    jQuery("#vehicle_vehiclesinformation_year").change(function () {
        year = jQuery(this).val();
        if (year != "") {
            jQuery("#vehicle_vehiclesinformation_make_loading").removeClass('hide');
            jQuery("#vehicle_vehiclesinformation_make").addClass('disable');

            jQuery("#vehicle_vehiclesinformation_make").children().not(":lt(1)").remove();
            jQuery("#vehicle_vehiclesinformation_model").children().not(":lt(1)").remove();
            jQuery("#vehicle_vehiclesdetails_trim").children().not(":lt(1)").remove();

            jQuery("#vehicle_vehiclesinformation_make").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a Make"));
            jQuery("#vehicle_vehiclesinformation_model").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a Model"));
            jQuery("#vehicle_vehiclesdetails_trim").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a trim"));

            jQuery.post('{{ path('find_makes_by_year')}}',
                    {
                        year_id: year
                    },
                    function (data) {
                        if (data.error != undefined && data.error != "")
                            alert(data.error);
                        jQuery("#vehicle_vehiclesinformation_make").children().remove();
                        jQuery("#vehicle_vehiclesinformation_make").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a Make"));

                        jQuery.each(data, function (i) {

                            var make_li;
                            make_li = '<option value="' + this.value + '">' + this.text + '</option>';
                            jQuery('#vehicle_vehiclesinformation_make').append(jQuery(make_li));

                        });
                        jQuery("#vehicle_vehiclesinformation_make_loading").addClass('hide');
                        jQuery("#vehicle_vehiclesinformation_make").removeClass('disable');
                    }, "json");

        }
    });

    jQuery("#vehicle_vehiclesinformation_make").change(function () {
        make = jQuery(this).val();
        if (make != "") {
            jQuery("#vehicle_vehiclesinformation_model_loading").removeClass('hide');
            jQuery("#vehicle_vehiclesinformation_model").addClass('disable');

            jQuery("#vehicle_vehiclesinformation_model").children().not(":lt(1)").remove();
            jQuery("#vehicle_vehiclesdetails_trim").children().not(":lt(1)").remove();

            jQuery("#vehicle_vehiclesinformation_model").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a Model"));
            jQuery("#vehicle_vehiclesdetails_trim").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a trim"));

            jQuery.post('{{ path('find_models_by_make')}}',

                    {
                        make_id: make
                    },
                    function (data) {
                        if (data.error != undefined && data.error != "")
                            alert(data.error);
                        jQuery("#vehicle_vehiclesinformation_model").children().remove();
                        jQuery("#vehicle_vehiclesinformation_model").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a Model"));

                        jQuery.each(data, function (i) {

                            var model_li;
                            model_li = '<option value="' + this.value + '">' + this.text + '</option>';
                            jQuery('#vehicle_vehiclesinformation_model').append(jQuery(model_li));
                        });
                        jQuery("#vehicle_vehiclesinformation_model_loading").addClass('hide');
                        jQuery("#vehicle_vehiclesinformation_model").removeClass('disable');
                    }, "json");

        }
    });

    jQuery("#vehicle_vehiclesinformation_model").change(function () {
        model = jQuery(this).val();
        if (model != "") {
            jQuery("#vehicle_vehiclesdetails_trim_loading").removeClass('hide');
            jQuery("#vehicle_vehiclesdetails_trim").addClass('disable');

            jQuery("#vehicle_vehiclesdetails_trim").children().not(":lt(1)").remove();
            jQuery("#vehicle_vehiclesdetails_trim").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a trim"));
            jQuery.post('{{ path('find_trims_by_model')}}',
                    {
                        model_id: model
                    },
                    function (data) {
                        if (data.error != undefined && data.error != "")
                            alert(data.error);
                        jQuery("#vehicle_vehiclesdetails_trim").children().remove();
                        jQuery("#vehicle_vehiclesdetails_trim").append(jQuery("<option></option>").attr("value", "").attr("selected", "selected").text("Select a Trim"));

                        jQuery.each(data, function (i) {

                            var trim_li;
                            trim_li = '<option value="' + this.value + '">' + this.text + '</option>';
                            jQuery('#vehicle_vehiclesdetails_trim').append(jQuery(trim_li));
                        });
                        jQuery("#vehicle_vehiclesdetails_trim_loading").addClass('hide');
                        jQuery("#vehicle_vehiclesdetails_trim").removeClass('disable');
                    }, "json");

        }
    });

    jQuery("#vehicle_vehiclesdetails_trim").change(function () {
        trim = jQuery(this).val();
        if (trim != "") {
            jQuery.post('{{ path('set_trims_session')}}',
                    {
                        trim_id: trim
                    },
                    "json");
        }
    });

    jQuery("#selectfile").click(function () {
        jQuery("#fileupload").trigger('click');
    });

    var count = 0;

    jQuery('.deleteImage').click(function (e) {

        if (confirm('Are you sure you want to delete this picture?')) {
            count++;
            var panelList = jQuery('.gallery');
            var div = document.createElement("div");
            var div1 = document.createElement("div");
            var span = document.createElement("span");
            jQuery(div1).addClass('image-form');
            jQuery(div).addClass('col-xs-3 col-xs-12 text-left');

            var aux = jQuery(jQuery('.col-xs-3', '.gallery')).length + count;
            var pictId = jQuery(jQuery(this).parent().find('input')[3]).val();


            jQuery.ajax({

                url: '{{path('new_image_form')}}',
                type: "POST",
                data: {i: aux, pictId: pictId, prop: "{{prop_pk}}"},
                async: false,
                success: function (response) {
                    jQuery(div1).html(response);

                }
            });

            jQuery(this).parent().remove();
            jQuery(span).addClass('orden');
            jQuery(span).html('24');
            jQuery(div1).append(span);
            jQuery(div).append(div1);

            jQuery(div).insertAfter(jQuery(jQuery('.col-xs-3', panelList)[22]));
            //document.getElementById("gallery").appendChild(div);

            jQuery('.col-xs-3', panelList).each(function (index, elem) {


                var $listItem = jQuery(elem),
                        newIndex = $listItem.index();
                // Persist the new indices.
                //alert(index);
                // jQuery('#gallery_propertyImages_'+index+'_order').val(newIndex);
                jQuery($listItem.find('.orden')).html(newIndex);
                jQuery($listItem.find('input')[0]).val(newIndex - 1);
            });

            panelList.sortable("refresh");
            if (jQuery(jQuery('.tumb')[0]).hasClass('old')) {
                jQuery(jQuery('.tumb')[0]).trigger('click');
            } else if (jQuery(jQuery(jQuery('.tumb')[0]).parent().find('input')[1]).val() == '') {
                jQuery('.top-content').hide();
            }

            jQuery('.tumb').removeClass('active');
            jQuery(jQuery('.tumb')[0]).addClass('active');
            var bg = jQuery(jQuery('.tumb')[0]).css("background-image");
            jQuery('.tumb-large').css("background-image", bg);
            e.preventDefault();
        }


    });

    jQuery('.deleteImagePreview').click(function (e) {
        jQuery(this).parent().find('.tumb').css("background-image", "url({{ asset('bundles/common/images/image-bg.jpg') }})");

        var control = jQuery(jQuery(this).parent().find('input')[1]);
        var title = jQuery(jQuery(this).parent().find('input')[2]);
        var id = control.attr('id');
        var name = control.attr('name');

        control.replaceWith(jQuery('<input type="file" id=' + id + '  name=' + name + '  accept="image/*" onchange="preview(this);" />'));
        jQuery(this).parent().find('.tumb').removeClass('active');
        jQuery('.top-content').hide();
        jQuery('.tumb').removeClass('active');
        jQuery(this).parent().find('.tumb').addClass('active');
        jQuery(this).addClass('hide');
        title.val('');
        e.preventDefault();

    });

    jQuery('#btnadd').click(function (e) {

        jQuery('#btnadd').css('display', 'none');
        jQuery('.title').css('display', 'block');
        jQuery('.featured-image').css('display', 'block');
        jQuery('#form-buttons').css('display', 'block');
        e.preventDefault();
    });

    jQuery('#saveTitle').click(function (e) {

        var orden = jQuery(jQuery('.tumb.active').parent().find('input')[0]).val();
        var photo = jQuery(jQuery('.tumb.active').parent().find('input')[1]).prop('files')[0];
        var title = jQuery('.title-input').find('input').val();
        var pictId = jQuery(jQuery('.tumb.active').parent().find('input')[3]).val();
        var newUpload = jQuery('#newUpload').val();


        if (photo) {

            var post_data = new FormData();
            post_data.append('id', '{{prop_pk}}');
            post_data.append('pictId', pictId);
            post_data.append('orden', orden);
            post_data.append('photo', photo);
            post_data.append('title', title);


            jQuery.ajax({
                statusCode: {
                    200: function () {
                        //alert('asdad');
                        jQuery(jQuery('.tumb.active').parent().find('input')[2]).val(title);
                        jQuery(jQuery('.tumb.active').parent().find('input')[2]).attr('value', title);
                        jQuery('.tumb.active').removeClass('upload');
                        jQuery(jQuery('.tumb.active').parent().find('input')[1]).attr("disabled", 'disabled');
                        jQuery(jQuery('.tumb.active').parent().parent().find('#deleteImage')).removeClass('hide');
                        // jQuery('.tumb.active').unbind('click');
                    }
                },
                url: '{{path('save_image')}}',
                type: "POST",
                data: post_data,
                processData: false,
                contentType: false,
                async: false,
                success: function (response) {
                    if (pictId == 'new') {
                        jQuery('.tumb.active').parent().parent().find('.deleteImage').removeClass('hide');

                    }

                }
            });

        }

        e.preventDefault();


    });

    if (jQuery('.gallery').find('.col-xs-3').length == 0) {

        jQuery('#btnadd').css('display', 'inline-block');
        jQuery('.title').css('display', 'none');
        jQuery('.featured-image').css('display', 'none');
        jQuery('#form-buttons').css('display', 'none')
    }

    jQuery('.tumb').each(function (index, value) {

        jQuery(document).on("click", ".tumb", function () {


            jQuery('.tumb').removeClass('active');
            jQuery(this).addClass('active');

            if (jQuery(this).hasClass('old')) {
                var bg = jQuery(this).css("background-image");
                jQuery('.tumb-large').css("background-image", bg);
            }
            var source = jQuery(this).parent().find('.title-input-source input').val();
            jQuery('.title-input input').val(source);


            if (jQuery(this).parent().parent().index() != 0) {
                jQuery('.featured-picture').hide();
                //jQuery('.tumb-large').css('border','0px');
            } else {
                jQuery('.featured-picture').show();
                //jQuery('.tumb-large').css('border','2px solid #39b1dc');
            }


        });


    });

    jQuery(function ($) {
        var panelList = jQuery('.gallery');
        panelList.sortable({
            grid: [3, 8],
            // Only make the .panel-heading child elements support dragging.
            // Omit this to make then entire <li>...</li> draggable.
            handle: '.tumb',
            update: function (event, ui) {
                jQuery('.tumb').removeClass('active');
                jQuery(ui.item).find('.tumb').addClass('active');
                var bg = jQuery(ui.item).find('.tumb').css("background-image");
                jQuery('.tumb-large').css("background-image", bg);
                var source = jQuery(ui.item).find('.tumb').parent().find('.title-input-source input').val();
                jQuery('.title-input input').val(source);
                if (ui.item.index() == 1) {

                    jQuery('.featured-picture').show();

                } else {

                    jQuery('.featured-picture').hide();
                }
                jQuery('.col-xs-3', panelList).each(function (index, elem) {

                    panelList.sortable("refresh");
                    var $listItem = jQuery(elem),
                            newIndex = $listItem.index();
                    // Persist the new indices.
                    //alert(index);
                    // jQuery('#gallery_propertyImages_'+index+'_order').val(newIndex);
                    jQuery($listItem.find('.orden')).html(newIndex);
                    jQuery($listItem.find('input')[0]).val(newIndex - 1);
                });

            },
            change: function (event, ui) {
                dragging = true;
            }

        });
    });

    jQuery(function () {

        jQuery(jQuery('.tumb')[0]).addClass('active');
        if (jQuery('.old').length == 0) {
            jQuery('.top-content').hide();
        } else {
            jQuery('.top-content').show();
            var bg = jQuery(jQuery('.tumb')[0]).css("background-image");
            jQuery('.tumb-large').css("background-image", bg);
        }


        var source = jQuery(jQuery('.tumb')[0]).parent().find('.title-input-source input').val();
        jQuery('.title-input input').val(source);
    });

});

jQuery(document).on("click", ".upload", function () {

    if (!dragging) {
        var $element_id = jQuery(this).attr("id");
        //jQuery("#" + $element_id + "_photo").trigger("click");
    }

});

jQuery(document).on("mousedown", ".upload", function () {
    dragging = false;
});

jQuery(document).on("keyup", ".title-input input", function () {
    jQuery(jQuery('.tumb.active').parent().find('input')[2]).val(jQuery(this).val());
});

function preview(input) {
    var panelList = jQuery('.gallery');
    //jQuery(input).parent().parent().find('#orden input').val(jQuery(input).index());
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function (e) {

            jQuery(input).parent().parent().find('.tumb').css('background-image', 'url(' + e.target.result + ')');
            jQuery('.tumb-large').css('background-image', 'url(' + e.target.result + ')');
        };
        reader.readAsDataURL(input.files[0]);
    }

    jQuery('.col-xs-3', panelList).each(function (index, elem) {

        panelList.sortable("refresh");
        var $listItem = jQuery(elem),
                newIndex = $listItem.index();
        // Persist the new indices.
        //alert(index);
        // jQuery('#gallery_propertyImages_'+index+'_order').val(newIndex);
        jQuery($listItem.find('.orden')).html(newIndex);
        jQuery($listItem.find('input')[0]).val(newIndex - 1);
    });

    jQuery('.tumb.active').parent().parent().find('.deleteImagePreview').removeClass('hide');
    jQuery('.top-content').show();

}

function handleFileSelect(evt) {
    var panelList = jQuery('.gallery');
    var output = panelList.find('.old').last().parent().parent();
    var files = evt.target.files; // FileList object
    panelList.sortable("refresh");
    // Loop through the FileList and render image files as thumbnails.
    for (var i = 0, f; f = files[i]; i++) {

        // Only process image files.
        if (!f.type.match('image.*')) {
            continue;
        }

        var reader = new FileReader();

        // Closure to capture the file information.
        reader.onload = (function (theFile) {
            return function (e) {
                // Render thumbnail.

                var length = jQuery('.old').length;
                var picFile = e.target;
                var div = document.createElement("div");
                var div1 = document.createElement("div");
                var div2 = document.createElement("div");
                var span = document.createElement("span");
                jQuery(div).addClass('col-xs-3 col-xs-12 text-left');
                jQuery(div1).addClass('image-form');
                jQuery(div2).addClass('tumb upload');
                var uploadId = length + i - files.length;
                jQuery(div2).attr('id', 'upload' + uploadId);
                jQuery(div2).css('background-image', 'url(' + picFile.result + ')');


                jQuery(div1).addClass('image-form');
                jQuery(div).addClass('col-xs-3 col-xs-12 text-left');
                jQuery(span).addClass('orden');


                jQuery(div1).append(div2);
                jQuery(div1).append(span);
                jQuery(panelList.find('.upload').parent().parent()[0]).remove();

                var post_data = new FormData();
                post_data.append('i', length + i++ - files.length);
                post_data.append('file', picFile.result);
                jQuery(span).html(uploadId);
                jQuery.ajax({

                    url: '{{path('image_multiple_form')}}',
                    type: "POST",
                    data: post_data,
                    processData: false,
                    contentType: false,
                    async: false,
                    success: function (response) {
                        jQuery(div1).append(response);
                        panelList.sortable("refresh");
                    }
                });

                jQuery(div).append(div1);
                jQuery(div).insertAfter(output);


            };
        })(f);

        // Read in the image file as a data URL.
        reader.readAsDataURL(f);
    }
    setTimeout(function () {
        jQuery('.col-xs-3', panelList).each(function (index, elem) {


            var $listItem = jQuery(elem),
                    newIndex = $listItem.index();
            // Persist the new indices.
            //alert(index);
            // jQuery('#gallery_propertyImages_'+index+'_order').val(newIndex);
            jQuery($listItem.find('.orden')).html(newIndex);
            jQuery($listItem.find('input')[0]).val(newIndex - 1);
        });
    }, 500);

    evt.preventDefault();
}

jQuery('.uploadMultipleVisible').click(function () {
    jQuery('#uploadMultiple').trigger('click');
});

var area = document.getElementById("vehiclewarranty_warranty");
var message = document.getElementById("count_back");
var maxLength = 800;
var checkLength = function () {
    if (area.value.length < maxLength) {
        message.value = (maxLength - area.value.length);
    }
}
if (area) {
    setInterval(checkLength, 300);
}

var area1 = document.getElementById("vehiclesellercomments_seller_comments");
var message1 = document.getElementById("count_back1");
var maxLength1 = 800;
var checkLength1 = function () {
    if (area1.value.length < maxLength1) {
        message1.value = (maxLength1 - area1.value.length);
    }
}
if (area1) {
    setInterval(checkLength1, 300);
}
</script>


